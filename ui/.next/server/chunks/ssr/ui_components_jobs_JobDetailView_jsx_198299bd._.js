module.exports=[37814,a=>{"use strict";var b=a.i(34765),c=a.i(63129),d=a.i(43426),e=a.i(51394),f=a.i(74725),g=Symbol.for("react.lazy"),h=d[" use ".trim().toString()];function i(a){var b;return null!=a&&"object"==typeof a&&"$$typeof"in a&&a.$$typeof===g&&"_payload"in a&&"object"==typeof(b=a._payload)&&null!==b&&"then"in b}function j(a){var c;let e,g=(c=a,(e=d.forwardRef((a,b)=>{let{children:c,...e}=a;if(i(c)&&"function"==typeof h&&(c=h(c._payload)),d.isValidElement(c)){var g;let a,h,i=(g=c,(h=(a=Object.getOwnPropertyDescriptor(g.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?g.ref:(h=(a=Object.getOwnPropertyDescriptor(g,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?g.props.ref:g.props.ref||g.ref),j=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(e,c.props);return c.type!==d.Fragment&&(j.ref=b?(0,f.composeRefs)(b,i):i),d.cloneElement(c,j)}return d.Children.count(c)>1?d.Children.only(null):null})).displayName=`${c}.SlotClone`,e),j=d.forwardRef((a,c)=>{let{children:e,...f}=a;i(e)&&"function"==typeof h&&(e=h(e._payload));let j=d.Children.toArray(e),k=j.find(m);if(k){let a=k.props.children,e=j.map(b=>b!==k?b:d.Children.count(a)>1?d.Children.only(null):d.isValidElement(a)?a.props.children:null);return(0,b.jsx)(g,{...f,ref:c,children:d.isValidElement(a)?d.cloneElement(a,void 0,e):null})}return(0,b.jsx)(g,{...f,ref:c,children:e})});return j.displayName=`${a}.Slot`,j}var k=j("Slot"),l=Symbol("radix.slottable");function m(a){return d.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===l}var n=a.i(95372),o=a.i(45833);let p=(0,n.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),q=d.forwardRef(({className:a,variant:c,size:d,asChild:e=!1,...f},g)=>(0,b.jsx)(e?k:"button",{className:(0,o.cn)(p({variant:c,size:d,className:a})),ref:g,...f}));q.displayName="Button";var r=a.i(68325),s=a.i(39744),t=a.i(48938);a.i(4050);var u=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,c)=>{let e=j(`Primitive.${c}`),f=d.forwardRef((a,d)=>{let{asChild:f,...g}=a;return(0,b.jsx)(f?e:c,{...g,ref:d})});return f.displayName=`Primitive.${c}`,{...a,[c]:f}},{}),v="horizontal",w=["horizontal","vertical"],x=d.forwardRef((a,c)=>{var d;let{decorative:e,orientation:f=v,...g}=a,h=(d=f,w.includes(d))?f:v;return(0,b.jsx)(u.div,{"data-orientation":h,...e?{role:"none"}:{"aria-orientation":"vertical"===h?h:void 0,role:"separator"},...g,ref:c})});x.displayName="Separator";let y=d.forwardRef(({className:a,orientation:c="horizontal",decorative:d=!0,...e},f)=>(0,b.jsx)(x,{ref:f,decorative:d,orientation:c,className:(0,o.cn)("shrink-0 bg-border","horizontal"===c?"h-[1px] w-full":"h-full w-[1px]",a),...e}));function z(a){let b=Math.max(0,Math.floor(a/1e3)),c=Math.floor(b/3600),d=Math.floor(b%3600/60),e=b%60;return c>0?`${c}h ${d}m`:d>0?`${d}m ${e}s`:`${e}s`}function A(a){return a?.task_request?.mode??"auto"}function B(a){try{let b=JSON.parse(a.data_json),c=b?.envelope,d=c?.type,e=c?.producer,f=c?.payload&&"object"==typeof c.payload?c.payload:b,g="string"==typeof f?.event_name?f.event_name:null,h="string"==typeof f?.message?f.message:a.message;return{parsed:b,payload:f,streamType:"string"==typeof d?d:"event",producer:"model"===e?"model":"system",eventName:g,displayMessage:h}}catch{return{parsed:{raw:a.data_json},payload:{raw:a.data_json},streamType:"event",producer:"system",eventName:null,displayMessage:a.message}}}function C(a,b=220){if("string"!=typeof a)return null;let c=a.trim();return c?c.length<=b?c:`${c.slice(0,b)}...`:null}function D({event:a}){var c;let[f,g]=(0,d.useState)(!1),[h,i]=(0,d.useState)(!1),{parsed:j,payload:k,streamType:l,producer:m,eventName:n,displayMessage:o}=B(a),{lines:p,prompt:q}=function(a,b,c){let d=[],e=null;if("state_change"===c)return(b?.from||b?.to)&&d.push(`state: ${b?.from??"?"} -> ${b?.to??"?"}`),{lines:d,prompt:e};if("mode"===a.phase&&(b?.configured_mode||b?.effective_mode)&&d.push(`mode: ${b?.configured_mode??"auto"} -> ${b?.effective_mode??"auto"}`),"action"===c)return b?.tool&&d.push(`tool: ${b.tool}`),b?.step_id&&d.push(`step: ${b.step_id}`),b?.arguments?.prompt&&"string"==typeof b.arguments.prompt&&(e=b.arguments.prompt),{lines:d,prompt:e};if("tool_result"===c){b?.tool&&d.push(`tool: ${b.tool}`),"boolean"==typeof b?.ok&&d.push(`ok: ${b.ok?"true":"false"}`);let a=b?.result?.summary;return"string"==typeof a&&d.push(`summary: ${C(a,180)}`),{lines:d,prompt:e}}if("artifact"===c){b?.name&&d.push(`artifact: ${b.name}`),b?.format&&d.push(`format: ${b.format}`);let a=b?.content?.summary;return"string"==typeof a&&d.push(`summary: ${C(a,180)}`),{lines:d,prompt:e}}if("model_output"===c){let a="string"==typeof b?.model_event_type?b.model_event_type:null,c="string"==typeof b?.model_event_subtype?b.model_event_subtype:null,f="string"==typeof b?.message_body?b.message_body:null,g=function(a){let b=(()=>{if(a&&"object"==typeof a&&!Array.isArray(a))return a;if("string"==typeof a)try{let b=JSON.parse(a);if(b&&"object"==typeof b&&!Array.isArray(b))return b}catch{}return null})();if(!b)return{type:null,subtype:null,preview:"string"==typeof a?C(a,180):null};let c="string"==typeof b.type?b.type:null,d="string"==typeof b.subtype?b.subtype:null,e=null,f=b?.message?.content?.find?.(a=>a?.type==="text")?.text;return"string"==typeof f&&(e=C(f,180)),e||"string"!=typeof b.result||(e=C(b.result,180)),{type:c,subtype:d,preview:e}}(b?.message);if(a||g?.type){let b=a??g?.type,e=c??g?.subtype;d.push(`model event: ${b}${e?`/${e}`:""}`)}return f?d.push(`preview: ${C(f,180)}`):g?.preview&&d.push(`preview: ${g.preview}`),{lines:d,prompt:e}}if("event"===c){"string"==typeof b?.message&&d.push(`detail: ${b.message}`);let a=b?.data?.effective_mode??b?.effective_mode,c=b?.data?.configured_mode??b?.configured_mode;(c||a)&&d.push(`mode: ${c??"auto"} -> ${a??"auto"}`),b?.data?.llm_prompt&&"string"==typeof b.data.llm_prompt?e=b.data.llm_prompt:b?.llm_prompt&&"string"==typeof b.llm_prompt&&(e=b.llm_prompt);let f=b?.data?.output?.summary??b?.output?.summary;"string"==typeof f&&d.push(`summary: ${C(f,180)}`)}return{lines:d,prompt:e}}(a,k,l),r=q?C(q,360):null,s="model_output"===l?function(a,b=800){if(null==a)return null;if("string"==typeof a)return C(a,b);try{return C(JSON.stringify(a,null,2),b)}catch{return C(String(a),b)}}(k?.message_body,700):null;return(0,b.jsxs)("div",{className:"relative pl-8",children:[(0,b.jsx)("div",{className:"absolute left-0 top-2 h-3 w-3 rounded-sm bg-slate-500"}),(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-3 transition hover:bg-muted/40",role:"button",tabIndex:0,onClick:()=>g(a=>!a),onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),g(a=>!a))},children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.phase}),(0,b.jsx)(e.Badge,{variant:"outline",className:"error"===(c=a.level)?"bg-rose-100 text-rose-900 border-rose-200":"warn"===c?"bg-amber-100 text-amber-900 border-amber-200":"bg-slate-100 text-slate-700 border-slate-200",children:a.level}),(0,b.jsx)(e.Badge,{variant:"outline",className:"bg-indigo-100 text-indigo-800 border-indigo-200",children:l}),(0,b.jsx)(e.Badge,{variant:"outline",className:"model"===m?"bg-fuchsia-100 text-fuchsia-800 border-fuchsia-200":"bg-slate-100 text-slate-700 border-slate-200",children:m}),n?(0,b.jsx)(e.Badge,{variant:"outline",className:"bg-cyan-100 text-cyan-800 border-cyan-200",children:n}):null,(0,b.jsx)("span",{children:a.created_at}),(0,b.jsxs)("span",{children:["#",a.id]}),a.attempt_id?(0,b.jsxs)("span",{children:["attempt:",a.attempt_id]}):null]}),(0,b.jsx)("p",{className:"mt-2 text-sm font-semibold",children:o}),p.length>0?(0,b.jsx)("div",{className:"mt-2 space-y-1",children:p.map((c,d)=>(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:c},`${a.id}-hl-${d}`))}):null,"model_output"===l?(0,b.jsx)("div",{className:"mt-2 space-y-2 rounded-md border bg-muted/40 p-2",children:s?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Body"}),(0,b.jsx)("pre",{className:"whitespace-pre-wrap break-words text-xs",children:s})]}):null}):null,r?(0,b.jsxs)("div",{className:"mt-2 rounded-md border bg-muted/40 p-2",children:[(0,b.jsx)("p",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Prompt"}),(0,b.jsx)("pre",{className:"whitespace-pre-wrap break-words text-xs",children:h?q:r}),q.length>r.length?(0,b.jsx)("button",{type:"button",className:"mt-2 text-xs font-medium text-blue-700 hover:underline",onClick:a=>{a.preventDefault(),a.stopPropagation(),i(a=>!a)},children:h?"Show less":"Show full prompt"}):null]}):null,f?(0,b.jsx)("pre",{className:"mt-3 overflow-x-auto rounded-lg bg-muted/50 p-3 text-xs",children:JSON.stringify(j,null,2)}):null]})]})}function E({task:a,attempts:f,events:g}){var h;let i,[j,k]=(0,d.useState)("all"),[l,m]=(0,d.useState)("all"),[n,o]=(0,d.useState)("all"),[p,u]=(0,d.useState)("all"),[v,w]=(0,d.useState)(""),x=(0,d.useMemo)(()=>["all",...new Set(g.map(a=>a.phase))],[g]),C=(0,d.useMemo)(()=>["all",...new Set(g.map(a=>a.level))],[g]),E=(0,d.useMemo)(()=>["all",...new Set(g.map(a=>B(a).streamType))],[g]),F=(0,d.useMemo)(()=>{let a=v.trim().toLowerCase();return[...g].sort((a,b)=>(Date.parse(a.created_at??"")||0)-(Date.parse(b.created_at??"")||0)).filter(b=>{if("all"!==j&&b.phase!==j||"all"!==l&&b.level!==l||"all"!==p&&String(b.attempt_id??"none")!==p)return!1;let c=B(b);return("all"===n||c.streamType===n)&&(!a||`${c.displayMessage}
${c.eventName??""}
${b.phase}
${b.level}
${b.data_json}`.toLowerCase().includes(a))})},[g,j,l,n,p,v]);return(0,b.jsxs)("main",{className:"ds-shell",children:[(0,b.jsxs)("header",{className:"mb-6 flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"ds-label",children:"Job Detail"}),(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:a?.title??"Task"}),(0,b.jsx)("p",{className:"font-mono text-xs text-muted-foreground",children:a?.id})]}),(0,b.jsx)(q,{asChild:!0,variant:"outline",children:(0,b.jsx)(c.default,{href:"/",children:"Back"})})]}),(0,b.jsxs)("div",{className:"grid gap-5 lg:grid-cols-5",children:[(0,b.jsxs)(r.Card,{className:"lg:col-span-2",children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Job"})}),(0,b.jsxs)(r.CardContent,{className:"space-y-3 text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Status:"})," ",(0,b.jsx)("span",{className:"ml-2",children:(0,b.jsx)(e.Badge,{variant:"outline",className:"done"===(h=a.status)?"bg-emerald-100 text-emerald-800 border-emerald-200":"running"===h||"leased"===h?"bg-blue-100 text-blue-800 border-blue-200":"queued"===h?"bg-amber-100 text-amber-900 border-amber-200":"failed"===h||"blocked"===h?"bg-rose-100 text-rose-900 border-rose-200":"bg-slate-100 text-slate-700 border-slate-200",children:a.status})})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Mode:"})," ",(0,b.jsxs)("span",{className:"ml-2",children:[A(a)," / ",function(a,b="unknown"){let c=a?.[a.length-1];if(!c?.output_json)return b;try{let a=JSON.parse(c.output_json);return a?.mode?.effective??b}catch{return b}}(f,A(a))]})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Type:"})," ",(0,b.jsx)("span",{className:"ml-2",children:a.type})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Attempts:"})," ",(0,b.jsxs)("span",{className:"ml-2",children:[a.attempt_count,"/",a.max_attempts]})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Elapsed:"})," ",(0,b.jsx)("span",{className:"ml-2",children:(i=Date.parse(a?.created_at??""))?z(((a?.status==="done"||a?.status==="failed"||a?.status==="blocked")&&Date.parse(a?.updated_at??"")||Date.now())-i):"-"})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"grid-label",children:"Updated:"})," ",(0,b.jsx)("span",{className:"ml-2 text-muted-foreground",children:a.updated_at})]}),a.last_error?(0,b.jsxs)("p",{className:"text-rose-700",children:[(0,b.jsx)("span",{className:"grid-label",children:"Error:"})," ",(0,b.jsx)("span",{className:"ml-2",children:a.last_error})]}):null,(0,b.jsx)(y,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"grid-label",children:"Prompt"}),(0,b.jsx)("p",{className:"mt-1 whitespace-pre-wrap text-sm",children:a.prompt})]})]})]}),(0,b.jsxs)(r.Card,{className:"lg:col-span-3",children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Attempts"})}),(0,b.jsx)(r.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[f.map(a=>{let c;return(0,b.jsxs)("div",{className:"rounded-xl border bg-muted/40 p-3",children:[(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["#",a.attempt_no," Â· ",a.status]}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["phase: ",a.phase]}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["started: ",a.started_at]}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["finished: ",a.finished_at??"-"]}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["elapsed: ",(c=Date.parse(a?.started_at??""))?z(((a?.finished_at?Date.parse(a.finished_at):Date.now())||Date.now())-c):"-"]})]},a.id)}),0===f.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No attempts yet."}):null]})})]}),(0,b.jsxs)(r.Card,{className:"lg:col-span-5",children:[(0,b.jsx)(r.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Execution Timeline"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[F.length," / ",g.length," events"]})]})}),(0,b.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-6",children:[(0,b.jsx)(s.Input,{className:"md:col-span-2",placeholder:"Search event text...",value:v,onChange:a=>w(a.target.value)}),(0,b.jsxs)(t.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Phase"})}),(0,b.jsx)(t.SelectContent,{children:x.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:"all"===a?"All phases":a},a))})]}),(0,b.jsxs)(t.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Type"})}),(0,b.jsx)(t.SelectContent,{children:E.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:"all"===a?"All types":a},a))})]}),(0,b.jsxs)(t.Select,{value:l,onValueChange:m,children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Level"})}),(0,b.jsx)(t.SelectContent,{children:C.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:"all"===a?"All levels":a},a))})]}),(0,b.jsxs)(t.Select,{value:p,onValueChange:u,children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Attempt"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All attempts"}),(0,b.jsx)(t.SelectItem,{value:"none",children:"No attempt"}),f.map(a=>(0,b.jsxs)(t.SelectItem,{value:String(a.id),children:["attempt ",a.attempt_no," (id:",a.id,")"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"relative space-y-3 pl-2",children:[(0,b.jsx)("div",{className:"timeline-rail absolute left-[13px] top-2 bottom-2"}),F.map(a=>(0,b.jsx)(D,{event:a},a.id)),0===F.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No events match current filters."}):null]})]})]})]})]})}y.displayName=x.displayName,a.s(["default",()=>E],37814)}];

//# sourceMappingURL=ui_components_jobs_JobDetailView_jsx_198299bd._.js.map