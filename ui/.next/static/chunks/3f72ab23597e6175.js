(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15117,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},59413,e=>{"use strict";var t=e.i(80663),s=e.i(62504),r=e.i(56916),l=e.i(40606),a=e.i(24025),n=Symbol.for("react.lazy"),o=r[" use ".trim().toString()];function i(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===n&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function d(e){var s;let l,n=(s=e,(l=r.forwardRef((e,t)=>{let{children:s,...l}=e;if(i(s)&&"function"==typeof o&&(s=o(s._payload)),r.isValidElement(s)){var n;let e,o,i=(n=s,(o=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(o=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),d=function(e,t){let s={...t};for(let r in t){let l=e[r],a=t[r];/^on[A-Z]/.test(r)?l&&a?s[r]=(...e)=>{let t=a(...e);return l(...e),t}:l&&(s[r]=l):"style"===r?s[r]={...l,...a}:"className"===r&&(s[r]=[l,a].filter(Boolean).join(" "))}return{...e,...s}}(l,s.props);return s.type!==r.Fragment&&(d.ref=t?(0,a.composeRefs)(t,i):i),r.cloneElement(s,d)}return r.Children.count(s)>1?r.Children.only(null):null})).displayName=`${s}.SlotClone`,l),d=r.forwardRef((e,s)=>{let{children:l,...a}=e;i(l)&&"function"==typeof o&&(l=o(l._payload));let d=r.Children.toArray(l),c=d.find(p);if(c){let e=c.props.children,l=d.map(t=>t!==c?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,t.jsx)(n,{...a,ref:s,children:r.isValidElement(e)?r.cloneElement(e,void 0,l):null})}return(0,t.jsx)(n,{...a,ref:s,children:l})});return d.displayName=`${e}.Slot`,d}var c=d("Slot"),u=Symbol("radix.slottable");function p(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===u}var m=e.i(98697),h=e.i(37440);let x=(0,m.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=r.forwardRef(({className:e,variant:s,size:r,asChild:l=!1,...a},n)=>(0,t.jsx)(l?c:"button",{className:(0,h.cn)(x({variant:s,size:r,className:e})),ref:n,...a}));f.displayName="Button";var g=e.i(89732),y=e.i(21010),j=e.i(68733);e.i(44939);var b=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let l=d(`Primitive.${s}`),a=r.forwardRef((e,r)=>{let{asChild:a,...n}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(a?l:s,{...n,ref:r})});return a.displayName=`Primitive.${s}`,{...e,[s]:a}},{}),v="horizontal",N=["horizontal","vertical"],_=r.forwardRef((e,s)=>{var r;let{decorative:l,orientation:a=v,...n}=e,o=(r=a,N.includes(r))?a:v;return(0,t.jsx)(b.div,{"data-orientation":o,...l?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...n,ref:s})});_.displayName="Separator";let w=r.forwardRef(({className:e,orientation:s="horizontal",decorative:r=!0,...l},a)=>(0,t.jsx)(_,{ref:a,decorative:r,orientation:s,className:(0,h.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...l}));function S(e){let t=Math.max(0,Math.floor(e/1e3)),s=Math.floor(t/3600),r=Math.floor(t%3600/60),l=t%60;return s>0?`${s}h ${r}m`:r>0?`${r}m ${l}s`:`${l}s`}function $(e){return e?.task_request?.mode??"auto"}function C(e){try{let t=JSON.parse(e.data_json),s=t?.envelope,r=s?.type,l=s?.producer,a=s?.payload&&"object"==typeof s.payload?s.payload:t,n="string"==typeof a?.event_name?a.event_name:null,o="string"==typeof a?.message?a.message:e.message;return{parsed:t,payload:a,streamType:"string"==typeof r?r:"event",producer:"model"===l?"model":"system",eventName:n,displayMessage:o}}catch{return{parsed:{raw:e.data_json},payload:{raw:e.data_json},streamType:"event",producer:"system",eventName:null,displayMessage:e.message}}}function k(e,t=220){if("string"!=typeof e)return null;let s=e.trim();return s?s.length<=t?s:`${s.slice(0,t)}...`:null}function T({event:e}){var s;let[a,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)(!1),{parsed:d,payload:c,streamType:u,producer:p,eventName:m,displayMessage:h}=C(e),{lines:x,prompt:f}=function(e,t,s){let r=[],l=null;if("state_change"===s)return(t?.from||t?.to)&&r.push(`state: ${t?.from??"?"} -> ${t?.to??"?"}`),{lines:r,prompt:l};if("mode"===e.phase&&(t?.configured_mode||t?.effective_mode)&&r.push(`mode: ${t?.configured_mode??"auto"} -> ${t?.effective_mode??"auto"}`),"action"===s)return t?.tool&&r.push(`tool: ${t.tool}`),t?.step_id&&r.push(`step: ${t.step_id}`),t?.arguments?.prompt&&"string"==typeof t.arguments.prompt&&(l=t.arguments.prompt),{lines:r,prompt:l};if("tool_result"===s){t?.tool&&r.push(`tool: ${t.tool}`),"boolean"==typeof t?.ok&&r.push(`ok: ${t.ok?"true":"false"}`);let e=t?.result?.summary;return"string"==typeof e&&r.push(`summary: ${k(e,180)}`),{lines:r,prompt:l}}if("artifact"===s){t?.name&&r.push(`artifact: ${t.name}`),t?.format&&r.push(`format: ${t.format}`);let e=t?.content?.summary;return"string"==typeof e&&r.push(`summary: ${k(e,180)}`),{lines:r,prompt:l}}if("model_output"===s){let e="string"==typeof t?.model_event_type?t.model_event_type:null,s="string"==typeof t?.model_event_subtype?t.model_event_subtype:null,a="string"==typeof t?.message_body?t.message_body:null,n=function(e){let t=(()=>{if(e&&"object"==typeof e&&!Array.isArray(e))return e;if("string"==typeof e)try{let t=JSON.parse(e);if(t&&"object"==typeof t&&!Array.isArray(t))return t}catch{}return null})();if(!t)return{type:null,subtype:null,preview:"string"==typeof e?k(e,180):null};let s="string"==typeof t.type?t.type:null,r="string"==typeof t.subtype?t.subtype:null,l=null,a=t?.message?.content?.find?.(e=>e?.type==="text")?.text;return"string"==typeof a&&(l=k(a,180)),l||"string"!=typeof t.result||(l=k(t.result,180)),{type:s,subtype:r,preview:l}}(t?.message);if(e||n?.type){let t=e??n?.type,l=s??n?.subtype;r.push(`model event: ${t}${l?`/${l}`:""}`)}return a?r.push(`preview: ${k(a,180)}`):n?.preview&&r.push(`preview: ${n.preview}`),{lines:r,prompt:l}}if("event"===s){"string"==typeof t?.message&&r.push(`detail: ${t.message}`);let e=t?.data?.effective_mode??t?.effective_mode,s=t?.data?.configured_mode??t?.configured_mode;(s||e)&&r.push(`mode: ${s??"auto"} -> ${e??"auto"}`),t?.data?.llm_prompt&&"string"==typeof t.data.llm_prompt?l=t.data.llm_prompt:t?.llm_prompt&&"string"==typeof t.llm_prompt&&(l=t.llm_prompt);let a=t?.data?.output?.summary??t?.output?.summary;"string"==typeof a&&r.push(`summary: ${k(a,180)}`)}return{lines:r,prompt:l}}(e,c,u),g=f?k(f,360):null,y="model_output"===u?function(e,t=800){if(null==e)return null;if("string"==typeof e)return k(e,t);try{return k(JSON.stringify(e,null,2),t)}catch{return k(String(e),t)}}(c?.message_body,700):null;return(0,t.jsxs)("div",{className:"relative pl-8",children:[(0,t.jsx)("div",{className:"absolute left-0 top-2 h-3 w-3 rounded-sm bg-slate-500"}),(0,t.jsxs)("div",{className:"rounded-xl border bg-card p-3 transition hover:bg-muted/40",role:"button",tabIndex:0,onClick:()=>n(e=>!e),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),n(e=>!e))},children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.phase}),(0,t.jsx)(l.Badge,{variant:"outline",className:"error"===(s=e.level)?"bg-rose-100 text-rose-900 border-rose-200":"warn"===s?"bg-amber-100 text-amber-900 border-amber-200":"bg-slate-100 text-slate-700 border-slate-200",children:e.level}),(0,t.jsx)(l.Badge,{variant:"outline",className:"bg-indigo-100 text-indigo-800 border-indigo-200",children:u}),(0,t.jsx)(l.Badge,{variant:"outline",className:"model"===p?"bg-fuchsia-100 text-fuchsia-800 border-fuchsia-200":"bg-slate-100 text-slate-700 border-slate-200",children:p}),m?(0,t.jsx)(l.Badge,{variant:"outline",className:"bg-cyan-100 text-cyan-800 border-cyan-200",children:m}):null,(0,t.jsx)("span",{children:e.created_at}),(0,t.jsxs)("span",{children:["#",e.id]}),e.attempt_id?(0,t.jsxs)("span",{children:["attempt:",e.attempt_id]}):null]}),(0,t.jsx)("p",{className:"mt-2 text-sm font-semibold",children:h}),x.length>0?(0,t.jsx)("div",{className:"mt-2 space-y-1",children:x.map((s,r)=>(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:s},`${e.id}-hl-${r}`))}):null,"model_output"===u?(0,t.jsx)("div",{className:"mt-2 space-y-2 rounded-md border bg-muted/40 p-2",children:y?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Body"}),(0,t.jsx)("pre",{className:"whitespace-pre-wrap break-words text-xs",children:y})]}):null}):null,g?(0,t.jsxs)("div",{className:"mt-2 rounded-md border bg-muted/40 p-2",children:[(0,t.jsx)("p",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Prompt"}),(0,t.jsx)("pre",{className:"whitespace-pre-wrap break-words text-xs",children:o?f:g}),f.length>g.length?(0,t.jsx)("button",{type:"button",className:"mt-2 text-xs font-medium text-blue-700 hover:underline",onClick:e=>{e.preventDefault(),e.stopPropagation(),i(e=>!e)},children:o?"Show less":"Show full prompt"}):null]}):null,a?(0,t.jsx)("pre",{className:"mt-3 overflow-x-auto rounded-lg bg-muted/50 p-3 text-xs",children:JSON.stringify(d,null,2)}):null]})]})}function A({task:e,attempts:a,events:n}){var o;let i,[d,c]=(0,r.useState)("all"),[u,p]=(0,r.useState)("all"),[m,h]=(0,r.useState)("all"),[x,b]=(0,r.useState)("all"),[v,N]=(0,r.useState)(""),_=(0,r.useMemo)(()=>["all",...new Set(n.map(e=>e.phase))],[n]),k=(0,r.useMemo)(()=>["all",...new Set(n.map(e=>e.level))],[n]),A=(0,r.useMemo)(()=>["all",...new Set(n.map(e=>C(e).streamType))],[n]),D=(0,r.useMemo)(()=>{let e=v.trim().toLowerCase();return[...n].sort((e,t)=>(Date.parse(e.created_at??"")||0)-(Date.parse(t.created_at??"")||0)).filter(t=>{if("all"!==d&&t.phase!==d||"all"!==u&&t.level!==u||"all"!==x&&String(t.attempt_id??"none")!==x)return!1;let s=C(t);return("all"===m||s.streamType===m)&&(!e||`${s.displayMessage}
${s.eventName??""}
${t.phase}
${t.level}
${t.data_json}`.toLowerCase().includes(e))})},[n,d,u,m,x,v]);return(0,t.jsxs)("main",{className:"ds-shell",children:[(0,t.jsxs)("header",{className:"mb-6 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"ds-label",children:"Job Detail"}),(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:e?.title??"Task"}),(0,t.jsx)("p",{className:"font-mono text-xs text-muted-foreground",children:e?.id})]}),(0,t.jsx)(f,{asChild:!0,variant:"outline",children:(0,t.jsx)(s.default,{href:"/",children:"Back"})})]}),(0,t.jsxs)("div",{className:"grid gap-5 lg:grid-cols-5",children:[(0,t.jsxs)(g.Card,{className:"lg:col-span-2",children:[(0,t.jsx)(g.CardHeader,{children:(0,t.jsx)(g.CardTitle,{className:"text-base",children:"Job"})}),(0,t.jsxs)(g.CardContent,{className:"space-y-3 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Status:"})," ",(0,t.jsx)("span",{className:"ml-2",children:(0,t.jsx)(l.Badge,{variant:"outline",className:"done"===(o=e.status)?"bg-emerald-100 text-emerald-800 border-emerald-200":"running"===o||"leased"===o?"bg-blue-100 text-blue-800 border-blue-200":"queued"===o?"bg-amber-100 text-amber-900 border-amber-200":"failed"===o||"blocked"===o?"bg-rose-100 text-rose-900 border-rose-200":"bg-slate-100 text-slate-700 border-slate-200",children:e.status})})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Mode:"})," ",(0,t.jsxs)("span",{className:"ml-2",children:[$(e)," / ",function(e,t="unknown"){let s=e?.[e.length-1];if(!s?.output_json)return t;try{let e=JSON.parse(s.output_json);return e?.mode?.effective??t}catch{return t}}(a,$(e))]})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Type:"})," ",(0,t.jsx)("span",{className:"ml-2",children:e.type})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Attempts:"})," ",(0,t.jsxs)("span",{className:"ml-2",children:[e.attempt_count,"/",e.max_attempts]})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Elapsed:"})," ",(0,t.jsx)("span",{className:"ml-2",children:(i=Date.parse(e?.created_at??""))?S(((e?.status==="done"||e?.status==="failed"||e?.status==="blocked")&&Date.parse(e?.updated_at??"")||Date.now())-i):"-"})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"grid-label",children:"Updated:"})," ",(0,t.jsx)("span",{className:"ml-2 text-muted-foreground",children:e.updated_at})]}),e.last_error?(0,t.jsxs)("p",{className:"text-rose-700",children:[(0,t.jsx)("span",{className:"grid-label",children:"Error:"})," ",(0,t.jsx)("span",{className:"ml-2",children:e.last_error})]}):null,(0,t.jsx)(w,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"grid-label",children:"Prompt"}),(0,t.jsx)("p",{className:"mt-1 whitespace-pre-wrap text-sm",children:e.prompt})]})]})]}),(0,t.jsxs)(g.Card,{className:"lg:col-span-3",children:[(0,t.jsx)(g.CardHeader,{children:(0,t.jsx)(g.CardTitle,{className:"text-base",children:"Attempts"})}),(0,t.jsx)(g.CardContent,{children:(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[a.map(e=>{let s;return(0,t.jsxs)("div",{className:"rounded-xl border bg-muted/40 p-3",children:[(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["#",e.attempt_no," Â· ",e.status]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["phase: ",e.phase]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["started: ",e.started_at]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["finished: ",e.finished_at??"-"]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["elapsed: ",(s=Date.parse(e?.started_at??""))?S(((e?.finished_at?Date.parse(e.finished_at):Date.now())||Date.now())-s):"-"]})]},e.id)}),0===a.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No attempts yet."}):null]})})]}),(0,t.jsxs)(g.Card,{className:"lg:col-span-5",children:[(0,t.jsx)(g.CardHeader,{className:"pb-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsx)(g.CardTitle,{className:"text-base",children:"Execution Timeline"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[D.length," / ",n.length," events"]})]})}),(0,t.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-6",children:[(0,t.jsx)(y.Input,{className:"md:col-span-2",placeholder:"Search event text...",value:v,onChange:e=>N(e.target.value)}),(0,t.jsxs)(j.Select,{value:d,onValueChange:c,children:[(0,t.jsx)(j.SelectTrigger,{children:(0,t.jsx)(j.SelectValue,{placeholder:"Phase"})}),(0,t.jsx)(j.SelectContent,{children:_.map(e=>(0,t.jsx)(j.SelectItem,{value:e,children:"all"===e?"All phases":e},e))})]}),(0,t.jsxs)(j.Select,{value:m,onValueChange:h,children:[(0,t.jsx)(j.SelectTrigger,{children:(0,t.jsx)(j.SelectValue,{placeholder:"Type"})}),(0,t.jsx)(j.SelectContent,{children:A.map(e=>(0,t.jsx)(j.SelectItem,{value:e,children:"all"===e?"All types":e},e))})]}),(0,t.jsxs)(j.Select,{value:u,onValueChange:p,children:[(0,t.jsx)(j.SelectTrigger,{children:(0,t.jsx)(j.SelectValue,{placeholder:"Level"})}),(0,t.jsx)(j.SelectContent,{children:k.map(e=>(0,t.jsx)(j.SelectItem,{value:e,children:"all"===e?"All levels":e},e))})]}),(0,t.jsxs)(j.Select,{value:x,onValueChange:b,children:[(0,t.jsx)(j.SelectTrigger,{children:(0,t.jsx)(j.SelectValue,{placeholder:"Attempt"})}),(0,t.jsxs)(j.SelectContent,{children:[(0,t.jsx)(j.SelectItem,{value:"all",children:"All attempts"}),(0,t.jsx)(j.SelectItem,{value:"none",children:"No attempt"}),a.map(e=>(0,t.jsxs)(j.SelectItem,{value:String(e.id),children:["attempt ",e.attempt_no," (id:",e.id,")"]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"relative space-y-3 pl-2",children:[(0,t.jsx)("div",{className:"timeline-rail absolute left-[13px] top-2 bottom-2"}),D.map(e=>(0,t.jsx)(T,{event:e},e.id)),0===D.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No events match current filters."}):null]})]})]})]})]})}w.displayName=_.displayName,e.s(["default",()=>A],59413)}]);